CREATE DATABASE EXERCISE_DB;

CREATE TABLE EXERCISE_DB.PUBLIC.CUSTOMER (
    ID int,
    first_name varchar,
    last_name varchar,
    email varchar,
    age int,
    city varchar
);

CREATE OR REPLACE STAGE EXERCISE_DB.PUBLIC.customer_stage 
    url='s3://snowflake-assignments-mc/fileformat/'


CREATE OR REPLACE FILE FORMAT EXERCISE_DB.PUBLIC.customer_file_Format
TYPE = csv 
FIELD_DELIMITER = '|' 
SKIP_HEADER=1;


LIST @EXERCISE_DB.PUBLIC.customer_stage;
DESC STAGE EXERCISE_DB.PUBLIC.customer_stage;


COPY INTO EXERCISE_DB.PUBLIC.CUSTOMER
FROM @EXERCISE_DB.PUBLIC.customer_stage
file_format = (FORMAT_NAME = EXERCISE_DB.PUBLIC.customer_file_Format);
--file_format= EXERCISE_DB.public.aws_fileformat
--VALIDATION_MODE = RETURN_ERRORS | RETURN_n_ROWS



